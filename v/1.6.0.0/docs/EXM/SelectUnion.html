Following section demonstrates using <hl>UNION</hl> clause.
<co type="warning" inline>
	to use the result column(s) of sub-select in another query expression; <b>name</b> or <b>index</b> can be specified.
</co>

<div class="row">
	<div class="col-md-12 col-lg">
		<code-tab>
			<pre lang="c#">
		var th = new TableHeader();
		var tl = new TableLines();
		
		// query 1
		var sql1 = Odb.SQL.Select(x =>
						x.From(th)
						 .GroupBy(th.Year)
						 .Fields(x["T1"], th.Year, x[th.Id].MAX().AS("MaxValue"))
					);

		// query 2
		var sql2 = Odb.SQL.Select(x =>
						x.From(tl)
						.GroupBy(tl.Year)
						.Fields(x["T2"], tl.Year, x[th.Id].MAX().AS("MaxValue"))
					);

		// union
		var sql = Odb.SQL.Union(x =>
						x.RemoveDuplicates()
						 .Add(sql1)
						 .Add(sql2)
						 .OrderASC(sql1[0]).OrderASC(sql1[1]).OrderDESC(sql1["MaxValue"])
					);
	</pre>
			<pre lang="vb">
		Dim th = new TableHeader()
		Dim tl = new TableLines()
		
		' query 1
		Dim sql1 = Odb.SQL.Select(Function(x) _
						x.From(th) _
						 .GroupBy(th.Year) _
						 .Fields(x("T1"), th.Year, x(th.Id).MAX().AS("MaxValue"))
					)

		' query 2
		Dim sql2 = Odb.SQL.Select(Function(x) _
						x.From(tl) _
						.GroupBy(tl.Year) _
						.Fields(x("T2"), tl.Year, x(tl.Id).MAX().AS("MaxValue"))
					)

		' union
		Dim sql = Odb.SQL.Union(Function(x) _
						x.RemoveDuplicates() _
						 .Add(sql1) _
						 .Add(sql2) _
						 .OrderASC(sql1(0)).OrderASC(sql1(1)).OrderDESC(sql1("MaxValue"))
					)
	</pre>
		</code-tab>
	</div>
	<div class="col-md-12 col-lg-4">
		<o class="h-100">
			<hl>SELECT * FROM (</hl>
			<div style="padding-left:30px;">
				(
				<div style="padding-left:30px;">
					SELECT 'T1' AS dyn_1, th.year, MAX(th.id) AS MaxValue<br />
					FROM [header] AS th<br />
					GROUP BY th.year<br />
				</div>
				)
				<hlb>UNION</hlb><br />
				(
				<div style="padding-left:30px;">
					SELECT 'T2' AS dyn_1, tl.year, MAX(tl.id) AS MaxValue <br />
					FROM [lines] AS tl <br />
					GROUP BY tl.year<br />
				</div>
				)
			</div>
			<hl>) AS t</hl><br />
			<hl>ORDER BY dyn_1 ASC, year ASC, C1 DESC</hl>
		</o>
	</div>
</div>
<a href="https://dotnetfiddle.net/2G0HiR" class="btn btn-outline-secondary btn-sm" target="_blank">Try it Yourself</a>